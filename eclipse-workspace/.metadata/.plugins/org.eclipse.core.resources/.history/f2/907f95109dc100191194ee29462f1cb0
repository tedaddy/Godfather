import org.json.JSONObject;
import org.json.JSONArray;
import org.json.JSONTokener;

import java.io.*;
import java.io.FileWriter;

import javax.swing.*;
import java.awt.event.*;



import java.io.FileInputStream;
import java.io.FileNotFoundException;

import java.util.Scanner;


public class DBmanager {
	
	private String resourceName = "src/databases/";
	//static AudioDriver audioDriver;
	

	/*public static void main(String[] args) {


		try {
			
			//DBmanager db = new DBmanager();
		    //variantModel variant = new variantModel();
			//variant.fromJSObject(db.getSource("test", 1));
			//variant.getTask(1);
			//variant.getTask(2);
			//variant.getTask(3);
			//variant.tasks = new String[] {"Billie", "Eilish", "number one"};
			//db.addSource("test", variant.createJSONObject());
		}catch(Exception ex) {System.out.println(ex);}

       // audioDriver = new AudioDriver();
       // audioDriver.start();

	}	*/
	
   /* public static void start() {
    	System.out.println("start"); 
   	    Timer tm = new Timer(3000, new ActionListener() {
	        public void actionPerformed(ActionEvent e) { 
	        	System.out.println("stop");       	
	        }
	    });
	    tm.start(); 
    }*/


    public JSONObject getSource(String databaseName, int number) {
    	String database = resourceName + databaseName + ".json";
    	try {
    		FileInputStream fstream = new FileInputStream(database);
            BufferedReader br = new BufferedReader(new InputStreamReader(fstream));
            JSONTokener tokener = new JSONTokener(br);
            JSONArray all_variants = new JSONObject(tokener).getJSONArray("items");
            JSONObject needed_var = all_variants.getJSONObject(number-1);
            return needed_var;
    	}catch(Exception ex) {
    		System.out.println(ex);
    		return null;
    	}
    
    }
    
    public int getCountOfVariants(String databaseName) {
    	String database = resourceName + databaseName + ".json";
    	int count;
    	try {
    	    FileInputStream fstream = new FileInputStream(database);
    	    BufferedReader br = new BufferedReader(new InputStreamReader(fstream));
    	    JSONTokener tokener = new JSONTokener(br);
    	    JSONArray all_variants = new JSONObject(tokener).getJSONArray("items");
    	    count = all_variants.length();
    	    return count;
    	}catch(Exception ex) {
    	    System.out.println(ex);
    	    return 0;
    	}
    }
    
    public void addSource(String databaseName, JSONObject jObject) {
    	String database = resourceName + databaseName + ".json";
    	try {
    	    FileInputStream fstream = new FileInputStream(database);
            BufferedReader br = new BufferedReader(new InputStreamReader(fstream));
            JSONTokener tokener = new JSONTokener(br);
            JSONArray ja = new JSONObject(tokener).getJSONArray("items");
            ja.put(jObject);
            JSONObject jo = new JSONObject();
            jo.put("items", ja);
		
            try (FileWriter file = new FileWriter(database)) {
	        	 
            	file.write(jo.toString());
            	file.flush();
	 
            } catch (IOException e) {
            	e.printStackTrace();
            	System.out.println(e);
            }
    	}catch(Exception ex) {}
    }
    
}
